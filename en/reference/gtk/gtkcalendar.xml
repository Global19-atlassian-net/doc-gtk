<?xml version="1.0" encoding="ISO-8859-1" ?>
<classentry id="gtk.gtkcalendar">
 <classmeta>
  <classtitle>GtkCalendar</classtitle>
  <classparent>GtkWidget</classparent>
  <shortdesc>
   A calendar offering dates that can be selected and marked.
  </shortdesc>
  <desc>
   <simpara>
    A <classname>GtkCalendar</classname> is a widget consisting of a grid
    container displaying a calendar, with an optional label allowing
    month/year navigation and an optional header giving abbreviated day names.
   </simpara>
   <simpara>
    Both the day and the month names are supplied by the system locale, and
    cannot be overwritten.  Unfortunately, under win32 there are severe
    problems with internationalization in the GDK source currently used by
    PHP-GTK.  Non-standard ISO8859-1/2 characters cannot be drawn in this
    widget as a result of a wide character conversion failure under Windows. 
    Multibyte characters are not recognised, and as they are supplied directly
    by the system to the widget there is no option to convert them using PHP. 
    This issue is gradually being addressed by the PHP-GTK development team on
    a widget-by-widget basis.
   </simpara>
   <simpara>
    Assuming that your locale and your operating system will allow you to use
    this widget's headers, the only other point to keep in mind is that a 
    <literal>marked</literal> date is differentiated from the other dates by
    being drawn on a slightly bigger base rectangle, making it appear bold
    while actually using the same font as the rest of the widget.  This is
    less effective in some fonts than in others, and can become a very
    negligable distinction.
   </simpara>
  </desc>
 </classmeta>

 <constructor id="gtk.gtkcalendar.constructor">
  <funcsynopsis>
   <funcprototype>
    <funcdef> <function>GtkCalendar</function></funcdef>
    <paramdef>void</paramdef>
   </funcprototype>
  </funcsynopsis>
  <shortdesc>
   Creates a calendar widget.
  </shortdesc>
  <desc>
   <simpara>
    Creates a calendar widget, set to display the current month and year.
   </simpara>
   <para>
    <example>
     <title>Changing the style of a GtkCalendar</title>
     <programlisting role="php">
dl(&quot;php_gtk.&quot; . (strstr(PHP_OS, &quot;WIN&quot;) ? &quot;dll&quot; : 
&quot;so&quot;));
    
$window = &amp;new GtkWindow();
$window-&gt;set_position(GTK_WIN_POS_CENTER);
$window-&gt;connect_object(&quot;destroy&quot;, array(&quot;gtk&quot;, 
&quot;main_quit&quot;));
    
/* create the calendar and add it to the window. */
$calendar = &amp;new GtkCalendar();
$window-&gt;add($calendar);
    
/* create a new style for the calendar, based on the old one */
$oldstyle = $calendar-&gt;style;
$newstyle = $oldstyle-&gt;copy();
$font = 
gdk::font_load('-unknown-Arial-normal-r-normal--*-160-*-*-p-0-iso8859-1');
$red = &amp;new GdkColor(255*255, 0, 0);
$newstyle-&gt;font = $font;
$newstyle-&gt;fg[GTK_STATE_SELECTED] = $red;
$calendar-&gt;set_style($newstyle);
    
/* have today's date highlighted on opening */
$calendar-&gt;select_day(date('d'));
    
$window-&gt;show_all();
    
gtk::main();
     </programlisting>
    </example>
   </para>
  </desc>
 </constructor>

 <methods>

  <method id="gtk.gtkcalendar.method.select_month">
   <funcsynopsis>
    <funcprototype>
     <funcdef>int <function>select_month</function></funcdef>
     <paramdef>int <parameter>month</parameter></paramdef>
     <paramdef>int <parameter>year</parameter></paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Determines the month and year displayed.
   </shortdesc>
   <desc>
    <simpara>
     This method determines the month and year displayed on opening.  The
     default setting is the current month and year, taken from the operating
     system.
    </simpara>
    <simpara>
     If the display option flag 
     <literal>GTK_CALENDAR_NO_MONTH_CHANGE</literal> is set, the user will be
     unable to switch from the month and year passed as parameters.
    </simpara>
    <simpara>
     Note that the month must be in the range <literal>0</literal> to
     <literal>11</literal>, similar to PHP's <literal>date('m')</literal>. 
     The year is in 4-digit format, as in <literal>2002</literal> 
     the format returned by <literal>date('Y')</literal>.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.select_day">
   <funcsynopsis>
    <funcprototype>
     <funcdef>void <function>select_day</function></funcdef>
     <paramdef>int <parameter>day</parameter></paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Determines the selected day.
   </shortdesc>
   <desc>
    <simpara>
     <function class="GtkCalendar">select_day()</function> specifies the
     day number that will be selected (i.e. highlighted).
    </simpara>
    <simpara>
     Note that if there are no further instructions, the same day will be
     highlighted throughout the months and years in the calendar.
    </simpara>
    <simpara>
     The default selected day is <literal>1</literal>, with the range
     being <literal>1</literal> to <literal>31</literal>.  Selecting an
     impossible day within that range - e.g. February 30th - does not
     return an error message, as the day number is not associated with the
     month and year information in this method.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.mark_day">
   <funcsynopsis>
    <funcprototype>
     <funcdef>int <function>mark_day</function></funcdef>
     <paramdef>int <parameter>day</parameter></paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Marks the given day.
   </shortdesc>
   <desc>
    <simpara>
     Switches the appropriate 
     <propname class="GtkCalendar">marked_date</propname> to
     <literal>true</literal> and marks the day number by making it appear
     bold.  If no further instructions are given, the same day number will
     be marked throughout the calendar.
    </simpara>
    <simpara>
     There is no limit to the number of marked days in a month.  There is
     also no limit to the range.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.unmark_day">
   <funcsynopsis>
    <funcprototype>
     <funcdef>int <function>unmark_day</function></funcdef>
     <paramdef>int <parameter>day</parameter></paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Unmarks the given day, if marked.
   </shortdesc>
   <desc>
    <simpara>
     Switches the appropriate 
     <propname class="GtkCalendar">marked_date</propname> to
     <literal>false</literal>, if it is <literal>true</literal>, and
     unmarks the day.
    </simpara>
    <simpara>
     If the day was not marked, this method has no effect whatever.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.clear_marks">
   <funcsynopsis>
    <funcprototype>
     <funcdef>void <function>clear_marks</function></funcdef>
     <paramdef>void</paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Clears all marked dates.
   </shortdesc>
   <desc>
    <para>
     Given that marked dates are identical on every calendar page, you will
     probably need to clear them and set a new bunch of marked dates when the
     month is changed.  These are best stored in a file or files, e.g.
     <informalexample>
      <programlisting code="php">
function new_month($calendar) {
  $calendar-&gt;clear_marks();
  $selected = $calendar-&gt;get_date();
  $month = ($selected[1]+1);
  $year = $selected[0];
  if(file_exists(&quot;diary/$year/marked_dates_$month.txt&quot;)) {
    $dates = fopen(&quot;diary/$year/marked_dates_$month.txt&quot;, 'r');
    $string = explode(',', fgets($dates));
    $calendar-&gt;freeze();
    for($i = 0; $i &lt; 31; $i++) {
      if($string[$i]==true) $calendar-&gt;mark_day($i+1);
    }
    $calendar-&gt;thaw();
    fclose($dates);
  }
}
    
$calendar-&gt;connect('month-changed', 'new_month');
      </programlisting>
     </informalexample>
    </para>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.display_options">
   <funcsynopsis>
    <funcprototype>
     <funcdef>void <function>display_options</function></funcdef>
     <paramdef>
      <enumname>GtkCalendarDisplayOptions</enumname> 
      <parameter>flags</parameter>
     </paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Sets flags determining the appearance of the calendar.
   </shortdesc>
   <desc>
    <simpara>
     Use <function class="GtkCalendar">display_options()</function> to
     choose which elements of the calendar should be displayed via
     <enumname>GtkCalendarDisplayOptions</enumname>.
    </simpara>
    <simpara>
     The default setting is <literal>GTK_CALENDAR_SHOW_HEADING | 
     GTK_CALENDAR_SHOW_DAY_NAMES</literal>.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.get_date">
   <funcsynopsis>
    <funcprototype>
     <funcdef>array <function>get_date</function></funcdef>
     <paramdef>void</paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Returns currently selected date.
   </shortdesc>
   <desc>
    <simpara>
     <function class="GtkCalendar">get_date()</function> returns the
     currently selected calendar date as an array.  The contents are the year
     (e.g. 2002), the month (1 - 12), and the day (1 - 31), in that order.
    </simpara>
    <note>
     <simpara>
      The range for the month is <literal>1 - 12</literal> here, but 
      <literal>0 - 11</literal> in the 
      <function class="GtkCalendar">select_month()</function> method.  Marked
      dates also run from <literal>0</literal>.  Beware!
     </simpara>
    </note>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.freeze">
   <funcsynopsis>
    <funcprototype>
     <funcdef>void <function>freeze</function></funcdef>
     <paramdef>void</paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Freezes the display to allow updates.
   </shortdesc>
   <desc>
    <simpara>
     <function class="GtkCalendar">freeze()</function> is used to prevent the
     screen flickering during an update as each string in the monthly array
     is evaluated and redrawn.  Place it before an update loop.
    </simpara>
    <simpara>
     See also: <function classname="GtkCalendar">thaw()</function>.
    </simpara>
   </desc>
  </method>

  <method id="gtk.gtkcalendar.method.thaw">
   <funcsynopsis>
    <funcprototype>
     <funcdef>void <function>thaw</function></funcdef>
     <paramdef>void</paramdef>
    </funcprototype>
   </funcsynopsis>
   <shortdesc>
    Thaws the display following updates.
   </shortdesc>
   <desc>
    <simpara>
     <function class="GtkCalendar">thaw()</function> is the corollary to 
     <function class="GtkCalendar">freeze()</function>, and is placed after
     an update routine.
    </simpara>
   </desc>
  </method>

 </methods>

 <signals>

  <signal id="gtk.gtkcalendar.signal.month-changed">
   <signalname>month-changed</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted whenever the displayed month is changed.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">month-changed</signalname> signal is
     emitted whenever the month on display changes, regardless of the way in
     which this is achieved.  As the month and year information are tied, 
     January 2002 is not the same month as January 2003 - the signal will be
     fired for a year change, too.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.day-selected">
   <signalname>day-selected</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when a day is selected.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">day-selected</signalname> signal is
     emitted when a day has been selected, regardless of the way in which this
     is achieved.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.day-selected-double-click">
   <signalname>day-selected-double-click</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when the mouse is clicked twice on a day.
   </shortdesc>
   <desc>
    <simpara>
     The 
     <signalname class="GtkCalendar">day-selected-double-click</signalname> 
     signal is fired when the user clicks the mouse on a day number twice in
     quick succession.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.prev-month">
   <signalname>prev-month</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when user chooses to go back one month.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">prev-month</signalname> signal is
     emitted when the user either clicks on the month arrow back, or when
     the user selects a greyed-out day from the previous month.  It cannot
     be emitted through the program itself; use 
     <signalname class="GtkCalendar">month-changed</signalname> if you need
     to do this.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.next-month">
   <signalname>next-month</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when user chooses to go forward one month.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">next-month</signalname> signal is
     emitted when the user either clicks on the month arrow forward, or when
     the user selects a greyed-out day from the following month.  It cannot
     be emitted through the program itself; use 
     <signalname class="GtkCalendar">month-changed</signalname> if you need
     to do this.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.prev-year">
   <signalname>prev-year</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when user chooses to go back one year.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">prev-year</signalname> signal is
     emitted when the user either clicks on the year arrow back, or when
     the user selects a greyed-out day from the previous December when
     January is currently displayed.  It cannot be emitted through the
     program itself; use 
     <signalname class="GtkCalendar">month-changed</signalname> if you need
     to do this.
    </simpara>
   </desc>
  </signal>

  <signal id="gtk.gtkcalendar.signal.next-year">
   <signalname>next-year</signalname>
   <callback>
    <funcprototype>
     <funcdef>void <function>callback</function></funcdef>
     <paramdef><classname>GtkCalendar</classname> calendar</paramdef>
    </funcprototype>
   </callback>
   <shortdesc>
    Emitted when user chooses to go forward one year.
   </shortdesc>
   <desc>
    <simpara>
     The <signalname class="GtkCalendar">next-year</signalname> signal is
     emitted when the user either clicks on the year arrow forward, or when
     the user selects a greyed-out day from the following January when
     December is currently displayed.  It cannot be emitted through the
     program itself; use 
     <signalname class="GtkCalendar">month-changed</signalname> if you need
     to do this.
    </simpara>
   </desc>
  </signal>

 </signals>

 <properties>

  <property id="gtk.gtkcalendar.property.month" type="ro">
   <propname>month</propname>
   <proptype>int</proptype>
   <shortdesc>
    Currently selected month.
   </shortdesc>
   <desc>
    <simpara>
     The <propname class="GtkCalendar">month</propname> property is an
     integer representing the currently selected month.  This will be in the
     range <literal>0 - 11</literal>.
    </simpara>
   </desc>
  </property>

  <property id="gtk.gtkcalendar.property.year" type="ro">
   <propname>year</propname>
   <proptype>int</proptype>
   <shortdesc>
    Currently selected year.
   </shortdesc>
   <desc>
    <simpara>
     The <propname class="GtkCalendar">year</propname> property is an
     integer representing the currently selected year.  This is in the
     4-digit format, i.e. <literal>2002</literal>.
    </simpara>
   </desc>
  </property>

  <property id="gtk.gtkcalendar.property.selected_day" type="ro">
   <propname>selected_day</propname>
   <proptype>int</proptype>
   <shortdesc>
    Currently selected day.
   </shortdesc>
   <desc>
    <simpara>
     The <propname class="GtkCalendar">selected_day</propname> property is
     an integer representing the currently selected day.  This will be in
     the range <literal>1 - 31</literal>.
    </simpara>
   </desc>
  </property>

  <property id="gtk.gtkcalendar.property.num_marked_dates" type="ro">
   <propname>num_marked_dates</propname>
   <proptype>int</proptype>
   <shortdesc>
    Number of marked dates held.
   </shortdesc>
   <desc>
    <simpara>
     The <propname class="GtkCalendar">num_marked_dates</propname> property is
     an integer representing the number of marked dates set to 
     <literal>true</literal> in the current 
     <propname class="GtkCalendar">marked_date</propname> array.  If you are
     using <classname>GtkCalendar</classname> fully, you are likely to have
     several of these arrays - one for each month, at a minimum.  This
     property is tied to the array.
    </simpara>
   </desc>
  </property>

  <property id="gtk.gtkcalendar.property.marked_date" type="ro">
   <propname>marked_date</propname>
   <proptype>array</proptype>
   <shortdesc>
    Array of marked dates.
   </shortdesc>
   <desc>
    <simpara>
     The <propname class="GtkCalendar">marked_date</propname> property is
     an array of 31 comma-separated values, all of which are either the
     default <literal>false</literal> or, if marked, <literal>true</literal>. 
    </simpara>
    <simpara>
     The array count begins at <literal>zero</literal>, whereas the days in
     the calendar begins at <literal>1</literal>.  You will need to add 
     <literal>1</literal> to an integer representing the position of a
     marked date, to compensate for this mismatch.
    </simpara>
   </desc>
  </property>

 </properties>

</classentry>
